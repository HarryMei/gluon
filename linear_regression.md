## 简介

这一部分，我先只借助MXNet的ndarray和autograd功能，将手动实现一个最基本的最简单的线性回归算法，测试一下性能，然后再使用MXNet的gluon来做一下，来做对比。

## 线性回归模型

### 1. 定义模型

由于是线性回归，所以只需定义自变量、系数和因变量的矩阵方程即可，如下所示`x`为自变量向量，`K`为系数矩阵（包括了偏置`b`），返回的结果为因变量。

```{.python .input  n=126}
import mxnet.ndarray as nd
import mxnet.autograd as ag
import numpy as np

def linear_module(x, K):
    return nd.dot(K, x.T)
```

### 2. 定义代价函数

选用方差和来做为代价函数，以衡量预测目标和真实目标之间的差距。

```{.python .input  n=10}
 def cost_function(yhat, y):
        return nd.sum((yhat - y)**2)
```

### 3. 梯度下降

```{.python .input  n=157}
def grad_descent(params, rate):
    params[:] -= rate*params.grad
```

## 生成模拟测试数据

我们使用一个线性函数加上随机噪声的结果作为我们测试的数据

```{.python .input  n=237}
def data_set_generate(number):
    w = nd.array([2.4,-5])
    b = 10
    x = nd.random_normal(shape = (number, 2))
    y = nd.dot(x, w.T) + b + 0.1 * nd.random_normal(shape=number)
    return x, y
```

检查数据集：

```{.python .input  n=145}
import matplotlib.pyplot as plt

test_datas, labels = data_set_generate(10000)
print('In:',test_datas.shape, ' Out:',labels.shape)
plt.scatter(test_datas[:,1].asnumpy(),labels.asnumpy())
plt.show()
```

```{.json .output n=145}
[
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "In: (10000, 2)  Out: (10000,)\n"
 },
 {
  "data": {
   "image/png": "iVBORw0KGgoAAAANSUhEUgAAAXwAAAD8CAYAAAB0IB+mAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz\nAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMS4wLCBo\ndHRwOi8vbWF0cGxvdGxpYi5vcmcvpW3flQAAIABJREFUeJzt3X+QHOV5J/Dvs6MWzOI7ZhXkxBpY\npMtRC8iC3WQLy1H+CLKNlCMSY2IiCKRcda7TP3bFImRzK+NYkoPtvdrKwR/x1RWVpEIVHF7AeA2W\nnYVYcnGnWMQr7wrYiA3YBKERCcpJowR2YFuzT/6Y6dH86O7pmemZ7un+fqooaX6/aKWn33ne531e\nUVUQEVH09QU9ACIi6g4GfCKimGDAJyKKCQZ8IqKYYMAnIooJBnwiophgwCciigkGfCKimGDAJyKK\niVVBD6DSFVdcoevXrw96GEREPeXYsWP/oqprGz0vVAF//fr1mJ2dDXoYREQ9RUTe9PI8pnSIiGKC\nAZ+IKCYY8ImIYoIBn4goJhjwiYhiIlRVOq2ansticmYRp3N5rEslMbZtCJmRdNDDIiIKlZ4P+NNz\nWex9+mXkzQIAIJvLY+/TLwMAgz4RUYWeT+lMziyWg70lbxYwObMY0IiIiMKp5wP+6Vy+qfuJiOKq\n5wP+ulSyqfuJiOKq5wP+2LYhJI1E1X1JI4GxbUMBjYiIKJx6ftHWWphllQ4RkbueD/hAMegzwBMR\nuWs74IvIpQBeAHBJ6f2eUtV9IrIBwLcArAHwUwC/p6rL7X5eN7G+n4iixI8c/gcAtqrqjQCGAWwX\nkc0A/geAB1X1GgDnAHzOh8/qGqu+P5vLQ3Gxvn96Lhv00IiIWtJ2wNeid0s3jdJ/CmArgKdK9z8C\nINPuZ3UT6/uJKGp8yeGLSALAMQD/GcA3AfwMQE5VL5SecgqAbS5ERHYD2A0Ag4ODfgzHF271/Uz1\nEFEv8qUsU1ULqjoM4EoANwG4zu5pDq99WFVHVXV07dqGJ3R1jVMdf6rfYKqHiHqSr3X4qpoD8CMA\nmwGkRMT6BnElgNN+flanOdX3q4KpHiLqSW0HfBFZKyKp0u+TAD4J4ASAwwA+U3raZwF8t93P6qbM\nSBrfuH0T0qkkBEA6lcQ3bt+E83nT9vls5UBEYSeqtpkW728gcgOKi7IJFC8gT6jqV0XkP+FiWeYc\ngHtU9QO39xodHdWwH2K+ZeIQsjbBPSGCFdXY5PS5jkEUHiJyTFVHGz2v7UVbVX0JwIjN/T9HMZ8f\nKWPbhqraMVsKpQtnHNozsyU1UW/q+V463Vab6kmI1D0n6jl9lqwS9SYG/DYVHFJiUc7psyU1UW+K\nRC+dbqpNZzjpE8GG8YMN89t+5MK7nU9fl0rarmOwJTVRuDHgN8kunWHHS07fj1y403vMvnkWh189\n05GLgN06BltSE4UfUzpNcktbNJvT9yMX7vQejx492bHNYU4lq1ywJQo3zvCb5JTOSKeSODK+FRvG\nD9q+zu5C0WouvDKF47Wo1rqQ+BWU2ZKaqPdwht+kRidsOeWxL08adfe1cjxjbRfPZmRzeWwYP4gt\nE4fYCoIohhjwm1SbzhjoN3DJqj7cOzWPLROHcPO1a2H01ad13lu+UBdkWzme0esaghMrxbNnah4j\nX32OgZ8oRtreaeunXthpW8muYidpJNAnwHvL9UHZSvvUvkdlhc3N1651XWzdMH6w6Zm9GwFw9+ZB\nPJDZ5OO7ElE3dW2nbZw5LZg6scvNV+bCvVTtOK0hAIDRJzBXmrscKIDHjp7E6NVrmJMnijimdNrQ\n7EajRnXqXqp2xrYNoT5hVLR6VZ/jY2609NmVpuey2DJxiDl/oghhwG+DY8/8pNF0bh7wVrWTGUk7\npnTeWy60nO7J5vLlwM7jHYmiiQG/DU6Lrvt3bmypTt1r1U6/0ZkfWzaXx9hTx3Hg2QX2yiGKIObw\n22AFcKe2BpUB3kqRnM7lkeo3oAqcz5tVrxnbNoSxJ49X5eGNPqn7ZpC/sNKx/yezoDi3xJ7/RFHE\ngN8mLxuQahdjKwNq5cIsANQm4c0Vxf5nFsqfBQBBFVaxVw5Rb2PA74JGtfOV6RKzUB/Nc3mzqlon\nIeLYpdMvSSPBXjlEEcMcfhd4SYVkc3nHckugeFG474njmJ7L4q6PXeXn8OqkkgZ75RBFEGf4XeBW\nO28RoGGFTUEVe6bmkUoauObDl+G1d97zbYyV9u/c6LlXTrOtmXk0IlFwGPC7wOlYRIuXYF8plzcd\nD1P3U2VwvjxpQATILV1caAbQVHtnHo1IFCy2VuiSyuBZW6XTaPbfbf1GH75++w2uF6mkkcAlq/qQ\ns7nw2LWQAJwPgB/oN9C/ehVn/UQt8tpagQE/BIYPPGcbOIPUb/RhyWyt/FMAvDFxa939zfQBGug3\nsG/HRgZ+Ig/YSycAreSnp+eyeG/5QpdG6F2rwR5w30Dm9dvMuSWT6R4in7FKxyettiOYnFm0LcXs\nFUaieuOAXfmmteksm8s31esnbxbKexCIqH0M+D5p9bjCXt+9aha0fKyjXflm5YUQKC5OW0E/nUoi\nZXMwTKVc3mQPHyKfMOD7pNXjCqOwe9XaBPb2+eLBKr+89/v48nTx2819TxyvuxAqLi7s7t+5sa4f\nUS328CHyBwO+T1o5rhCwb8DWq6wWQAVVPHr0JP5gat5xR7B1IbROEHOb6ff6tyCisGDA90krxxUC\nFwOetNLIPuQaLftavfYBYH7fLRjotw/6UfgWRBQGDPg+qT3rtpl2BJmRdMNcdtQoqs/Xvf6Pf4Bl\nmy6g7OFD5B+WZfrIazsCOzmHlsRxYVcGavSBPXyIfMQZfkgwbVHPXAH2TM3XHbHI4xeJWsOdtiEx\nPZfFnqn5oIcRWkkjgV8ZvBx/+7Ozdbt1k0aC3wQo1rzutOUMPyQyI2nHRUsq7mk4YhPsrcdYuknU\nGAN+iOzb0bgmnexZh7AzzUPkjIu2IVJ5Rm7YOmiGnQDlP7Nm2i6zPz/FCXP4IdZMd0mq59Sm2VLb\nnx8oXjju3jyIBzKbujBCIn90LYcvIleJyGEROSEiCyLyxdL9a0TkeRF5rfTrQLuf1ctaqSxJMaff\nlkY7dO36HymAx46eZEqIIsmPHP4FAPep6nUANgP4vIhcD2AcwA9V9RoAPyzdjqVWOmlOz2Xx7vvu\nbZONhMDoi+AWXZ80KnV1uiAo2L+HoqntgK+qb6vqT0u//zcAJwCkAdwG4JHS0x4BkGn3s3pVK500\nJ2cWYa7UJ3Sk9F86lcTkZ27E5B03+jza6FhavuB6UXW7ILB/D0WRr4u2IrIewAiAFwH8oqq+DRQv\nCiLyYT8/q5e00knT7bHa06QOPLuAczHfqWun0SEqY9uGcO/UvO06CTfCURT5VpYpIh8C8G0Ae1T1\nX5t43W4RmRWR2TNnzvg1nFBppZNmM6/Zt2NjawOLgbxZwJ6peVz3xz+om+1nRtK4e/Ng3aEs7N9D\nUeVLwBcRA8Vg/5iqPl26+59F5COlxz8C4B2716rqw6o6qqqja9eu9WM4odNKJ02vr7HKCsld3lzB\nH0zN1wX9BzKb8OCu4Zaa3hH1mrbLMkVEUMzRn1XVPRX3TwL4/6o6ISLjANao6h+5vVeUyzJbPe/W\n7TV2ZYXkTUIEd33sKpZfUiR4Lcv0I+D/OoD/C+BlXGyB/iUU8/hPABgEcBLAHap61u29ohzwO8E6\nJ5Zadw9r7ikCvAb8thdtVfX/AY5nU3+i3fcnZ6wkad9jR0/i4Etvlxe9+40+rF6VwPm8yZ23FDns\npdPDWEnSPgWqKpyWzBXk8mZ5v8TYk8e5CYsigwG/hzkt7JJ/zBXF/mcWgh4GkS8Y8HuY07GK92we\nDHpokZLLc48DRQO7ZfY4u2MVrduPHj0ZxJAiacvEIebzqedxhh9Ro1evcVxJp+ZZh62PfPU55vSp\nZ3GGH1GTM4tsrdwB55ZMjD11HE/OnsTRn59DQZU1/dQzGPAjiiWbnWMWFEd+dnFLSUG1nD5j0Kcw\nY0onopot2TT6BEaCSaB2PP7iW0EPgcgVA35E2ZVsujFXFEafMO/fhkKITo8jssOAH1FWyWZCvIfw\nJXOFef828QB1CjPm8CMsM5LGvVPzQQ8jVqzTzGbfPIvDr57B6VwelycNiAC5pWK7hpuvXVt+jO0b\nqJsY8CNuXSrJBmtdljcLVXsgKjduZXP5qsesCwRgf0gLkZ+Y0ok4r7n8JjI/5LNGx10S+YUBP+Jq\n2y8M9Bt1B58bCUFyFf8qBIlltNQNTOnEQG37hcqDVVL9Bs4vmTALXK4NEjufUjcw4MdQ5QVg+MBz\n5VNrKDg3XxvN4z0pXBjwY46dIMPh6WOnWLlDHceATxQCS+YKlkp5fFbuUKdwpS7mBvoNx8dYuBMc\nVu5QJzDgx9y+HRsde+hwGTdYrNwhvzGlE3NWymAPd+SGzuVJA8MHniuvswz0G9i3YyPTPNQyzvAJ\nmZE00iwLDJ1c3qxaVLd68Xvt1TM9l8WWiUPYMH6QPX4IAAM+lTTbXZOCYRbUU25/ei6LvU+/jGwu\nD8XFhWAG/XhjwCcA9geiUzhlc3nXWfv0XBb3PXEcebNQdT8Xgok5fCqr3ZG7fvxggKMhN5WzduDi\nWow1s3fqzc+F4HjjDJ8cuZVsUjjkzQL2TM2XZ/uTM4t1M/tKbOEQbwz45MitZJPCxZrtu7XCThoJ\njG0bAsAF3bhiSoccWWmCyZlF9tTvAXmzgISIbTonIYJv3L4JmZF0Oe1jfRPgzt744AyfXGVG0jgy\nvhX/OHErUzw9oKBaV22VNBL409+5seoCzgXdeGLAJ89yS2y0FgZu5xSnU8m6aitrZm9xWrjlgm70\nMaVDnvG4xHBwqsABgNzSMu6dmse6VBIP7hq2TdE4/Ry5oBt9nOGTZ9ycFX7vLRcabrSy+zlWLuhS\ndDHgk2eVm7OAi6kF69d0KomHdg2zy2ZIOOXl7TbZ1aZ9KJpEXb4edtvo6KjOzs4GPQxq05aJQ0z9\nhIQAeGPi1qCHQR0mIsdUdbTR8zjDJ981k/rZ8strOjyaeOsTYa09lTHgk+9qUwZuHvtvH+/KmOKq\noFrO6e+ZmsfwgecY+GPMl4AvIn8pIu+IyCsV960RkedF5LXSrwN+fBb1Bqt+30s64bLVXAjullze\nZNfMGPNrhv9XALbX3DcO4Ieqeg2AH5ZuUww5bdiy7v/apzd1czixx01W8eVLwFfVFwCcrbn7NgCP\nlH7/CICMH59FvcPq13LOZsOWkRDs27ERQPHbwD2bB7s9vFjjJqt46mQO/xdV9W0AKP364Q5+FoVM\n5QEcFiufn04lMfmZG6vKAB/IbGLrhi7iJqt4CnynrYjsBrAbAAYHOcuLCrt+LYpisD8yvrU8+z+d\ny2NdKomxbUNs3dBFlV0zJ2cWq34OrMePLt/q8EVkPYDvqepHS7cXAfyGqr4tIh8B8CNVdd3Kxzr8\n6NgwfhB2f7MEwIO7hqu6NQLFnZ6XGn226R/yXyppVJ2Xa0kaCW7C6kFhqMN/BsBnS7//LIDvdvCz\nKGScUgbrUknHbo2qYOuGLrEL9oD9gi5750eHX2WZjwP4MYAhETklIp8DMAHgUyLyGoBPlW5TTLj1\na3FaMDyfNz3X71PnZHP5clDnYejR4ksOX1XvcnjoE368P/Weyt7rtflhpwNV1qWS5XN1rYO43TpD\nUueMPXkcgHvvfKZ9ek/gi7YUXbWHolvGtg3Z5vArFxLdDuIG4HiyE/nDXFHXCy7LOnsTWytQ1zXq\n1tjoIG4AWFEtd+2kznC7oLKsszdxhk+BcJr9A95mj1aK6N6pedtqIOqc2t75LO3sHZzhU+g0mj1a\nASczksbd3KHbVf1GX9W3MS7q9hYGfAoduwqfyl26lQFn9Oo1MPpY09MtH1zQqtl7sweis8QzWEzp\nUOhU5vKzuXx5gTZtky6YnFmEucKkTrcUVLFh/GA5ddPMgejWtwHrAmF9GwDAFFCXcIZPoZQZSZdn\n+tbioV26gNUi3VeZurk8ad//yO7glWa/DZD/GPAptJwCxP5nFsq3WS0SnLxZwPn3TRiJ+pRa5cEr\nY08dx/RctqlvA9QZDPgUWk6BIJc3y7NGt3w/dZ4qUCgoBvoNCACx+cM3C4oDzy64ttug7mDAp9By\nCwRWGsCupv/XeE5uV60AeN8s4I2JW+FUun9uyXRtt0HdwUVbCq2xbUPYMzVv+1jl7L+2pn/LxKGO\nj42q5c2VhhU3bu02qDsY8Cm0MiNpHHh2wbZlstvs365PD3Xenql5CODYFnt6Luu64Y46jykdCrV9\nOzY2lQaYnssyhx8gpwJZBbghKwQY8CnUGvXdqTU5s8hWCyHFEszgMaVDoddMGoAlfuGWzeWxZeJQ\n+Rsa8/ndxYBPkbIulWQOP+SyuXzdYjx33XYHUzoUKU6lf/0G/6qHHVM+nccZPkWKU+kfAIw9dRxm\ngRn+MGNKrrMY8Cly3HL+TmWeFA7cddtZDPgUG5UXAuvQDrd8f9JIQKBYMle6NcTYyy0tl+v1yX9M\nbFIsZUbSODK+FQ/tGq7L+QPAQL+Bb9y+CV+//QYk2G+/a95bLrBev4M4w6dY87rd/0tPv8SZfpdY\ni7ec5ftP1OWg4m4bHR3V2dnZoIdBVGd6LuvY14c6Z6DfwL4dGxn8GxCRY6o62uh5TOkQecBywWCc\nWzLL/fSpfUzpEHnAcsHgmAV1TPFYi+/cresNZ/hEHrBcMFhuZ+Rmc/mqYxf5bcAZAz6RB047eAf6\n7c90JX/ZXXB5Rm7zmNIh8oA7eIN187Vr6+7jGbnNY8An8shpB+/+ZxaQyzfevZsQQSFEVXG95NvH\nshi9ek3Vn79Tozym35wxpUPUpvMegn3SSOBPf+fGLowmmuxSNU4H2Nt9G6AiBnyiNjWaUTY6tIW8\nqU3VZEbS+O1fTVedcKYofhvgwq09BnyiNjnNNO/ZPIh/nLgVR8a3loN9QtimoVV2F9bDr56pO+Es\nbxZw4NmF7gyqxzDgE7XJOoYxlbxYsZPqNzB69Zq65971sau6ObRIWf8L9QHfaYH23JLJWb4NBnwi\nn3xw4WKvnXNLpm1N+AOZTbhn82C3hxYJR352Fl+efrnqPrd0Gssz6zHgE/mgmZrwBzLFQ9mpeY+/\n+FbVbas01g7LM+sx4BP5wCm4WId2bxg/iC0Th8oz/rFtQzDYdrlptWWtmZE0kg7HV7I8s17HA76I\nbBeRRRF5XUTGO/15REFwCi4C2G79z4ykMXkHyzRbUXnhnJ7LYtlh05t1sWUu/6KOBnwRSQD4JoDf\nBHA9gLtE5PpOfiZREJwqdewqSKw0T2YkzdROC7K5PMaeLHbQPPDsAgorzpvZ2F+nWqdn+DcBeF1V\nf66qywC+BeC2Dn8mUddZlTrpVBKCYu29UxiqTP/YXSiMPuEpWw2YK4p7p+Y9nU/M/joXdbq1QhpA\n5SrLKQAfq3yCiOwGsBsABgdZvUC9q7b1wpaJQw23/rv16OGB6+6aaVLBBdyiTgd8u2lK1c9JVR8G\n8DBQPPGqw+Mh6pqxbUPY+/TLVdU7SSNRV1ni1KPHum/9+MHODjQGuIBb1OmAfwpA5U6TKwGc7vBn\nEoWC1/NyqfPYX6eo0wH/JwCuEZENALIA7gTwux3+TKLQcJq9N2Og33BM7RgJYWtmDw6/eiboIYRC\nRxdtVfUCgC8AmAFwAsATqsomF0RN2Ldjo+Njl61eVV4o5mEszpjDL+p4P3xV/T6A73f6c4ji6Hze\nxPy+W8q3nRaK465PBF+efhmHXz0T6/Qad9oShZxbSWHtYqRbq4E4K6ji0aMnY3/+LQM+Uci5pSOW\nli9UtW3IjKSrunaSszjW5zPgE4WcW0nhuSWzbsa6f+fGus1cZC9uuX0GfKKQc2rbUKtyxnrJqov/\ntAf6DTj0F4u9uNXn868BUcg107bBmulXHqr+vrkCc8XhBTEXtzWPjlfpEFH7vLZtSIjY9uW3a+RG\n8cMZPlEPskvzJI1EXb94iwLsv28jbpU6DPhEPcguzWPddvKhS1exHXONvFnA/mcWbA+piSKmdIh6\nlFPbhj1T87bPzy2ZmPvKLZiey9Y1dauVLm1Mmn3zLB5/8S3Hbw5h49aGwkkub5bXPKw1EACR3JTF\nGT5RhGRG0o4tFqyKFOvbgd3zkkYCD+0axpHxrQCAbx/L9kywB4B33zfbLkmNcn0+Az5RxOzbUV+H\nX9uWOTOSxtxXbsFDu4br0kKVXT7dvgWEkbkCX8Yc1fp8pnSIIqaZtsxu3TyjGvS8iGp9PgM+UQT5\n0ZZ5XSoZy0ZsdofURAVTOkRky670M6qc0lpRwxk+EdmqTQ2l+g2oomoXb1RYi9RRx4BPRI5qU0PT\nc1ncOzUfqV27cdqOxpQOEXk2ObPoe7C/Z/NgxzeEXbbaOTUVpYtXIwz4RORZO5U7VlBPiJRvP7Rr\nGA9kNnV0vSCVNLDw1e2OF5VU0uBOWyKiWq1W7qRTSdc8ee16gV+z7qSRwP6dxTOBx7YNYezJ4zBX\nLr57H4D3li+47rSdnst6KnHtBZzhE5FnTjPxRv32l5YvNJw5Z0bSODK+FW9M3OpLiieVNOorbmoS\n9isAzEL15aVyp63VhiIqRyMy4BORZ3ZN2x7aNYzXvn6r6+vOLZlNBcqxbUNtd/e87JLqBMbkzGJd\ncHdipa7sdhv3cusFpnSIqClOm7rSDdI9VqD0kg7JjKRx4NmFphuhVapNzzSz/mDttHV6Ta/uQuYM\nn4h8cfO1axs+p5lAmWsj2FsqZ+Ne2yVU7rR1ek2vtl5gwCciXxx+9UzD5zQTKFMOXT+bZV1kvFQC\nDfRX5/2dDprp1dYLDPhE5ItGs/dmAuX0XBbvvn/Bj2FVtYX+7V9Nl8tC7fSvXlWVcnI6aKZXq3SY\nwyciX1yeNBzbLqSbLGecnFmsKp+0OJ3Na71/7cEulReZ6blsw/7+dmsQzTSiC3sJJwM+EfnCaeI8\n0G803avG6duCohjE7YJ6o7bQXvr7u83+7VQG+FS/gXffv1C+UIXx9CwGfCLyhdMiayuLr04bvKyZ\nvFNQb7e/fzOne9UeFWlXUdRMZVI3MOATkS+cgnQrFS1u6ZlWe/172SXczIYvryeCZXN5bBg/GIoU\nDxdticgXfla0dGKxtFGVTrNjbabENCy7dDnDJyJfNHO0otf383M27NTf/3zebGmsrfQVCjrFIxqi\nE+lHR0d1dnY26GEQUQiEveKlNocPAEZCcNnqVTifNx0bwAmANybcW1E0S0SOqepoo+dxhk9EoVMb\nTMNY8dLoG82WiUO+rWn4hQGfiELHrWlZWAI+4J52arQvIAgM+EQUOlFoWub3moYf2gr4InIHgP0A\nrgNwk6rOVjy2F8DnABQA/L6qzrTzWUQUH36WeAbJ74XndrVblvkKgNsBvFB5p4hcD+BOABsBbAfw\nv0SkM+eXEVHkRK1pWVi0NcNX1RMAIPXbkW8D8C1V/QDAGyLyOoCbAPy4nc8jongIYzokCjqVw08D\nOFpx+1TpPiIiT8KWDomChgFfRP4GwC/ZPHS/qn7X6WU299mWpYrIbgC7AWBwcLDRcIiIqEUNA76q\nfrKF9z0F4KqK21cCOO3w/g8DeBgobrxq4bOIiMiDTvXSeQbAnSJyiYhsAHANgL/r0GcREZEHbQV8\nEfm0iJwC8HEAB0VkBgBUdQHAEwD+HsBfA/i8qjZuK0dERB3TbpXOdwB8x+GxrwH4WjvvT0RE/mF7\nZCKimGDAJyKKCQZ8IqKYYPM0IqKAdLvnPwM+EVEAguj5z5QOEVEA3Hr+dwoDPhFRAILo+c+AT0QU\nAKfe/p3s+c+AT0QUgCB6/nPRlogoAEH0/GfAJyIKSLd7/jOlQ0QUEwz4REQxwYBPRBQTDPhERDHB\ngE9EFBOiGp5jZEXkDIA3O/wxVwD4lw5/RrPCOCYgnOPimLwL47jCOCYgnONqZkxXq+raRk8KVcDv\nBhGZVdXRoMdRKYxjAsI5Lo7JuzCOK4xjAsI5rk6MiSkdIqKYYMAnIoqJOAb8h4MegI0wjgkI57g4\nJu/COK4wjgkI57h8H1PscvhERHEVxxk+EVEsxTbgi8gfioiKyBVBjwUARORPROQlEZkXkedEZF0I\nxjQpIq+WxvUdEUkFPSYAEJE7RGRBRFZEJNDKChHZLiKLIvK6iIwHORaLiPyliLwjIq8EPRaLiFwl\nIodF5ETpZ/fFEIzpUhH5OxE5XhrTgaDHZBGRhIjMicj3/HzfWAZ8EbkKwKcAnAx6LBUmVfUGVR0G\n8D0AXwl6QACeB/BRVb0BwD8A2BvweCyvALgdwAtBDkJEEgC+CeA3AVwP4C4RuT7IMZX8FYDtQQ+i\nxgUA96nqdQA2A/h8CP6sPgCwVVVvBDAMYLuIbA54TJYvAjjh95vGMuADeBDAHwEIzQKGqv5rxc3L\nEIKxqepzqnqhdPMogCuDHI9FVU+oaucO/vTuJgCvq+rPVXUZwLcA3BbwmKCqLwA4G/Q4Kqnq26r6\n09Lv/w3FYNa9vsD2Y1JVfbd00yj9F/i/OxG5EsCtAP7c7/eOXcAXkZ0Asqp6POix1BKRr4nIWwDu\nRjhm+JX+K4AfBD2IkEkDeKvi9ikEHMR6gYisBzAC4MVgR1JOncwDeAfA86oa+JgAPITihHTF7zeO\n5AEoIvI3AH7J5qH7AXwJwC3dHVGR27hU9buqej+A+0VkL4AvANgX9JhKz7kfxa/kj3V6PM2MKwTE\n5r7AZ4hhJiIfAvBtAHtqvtUGQlULAIZL61PfEZGPqmpgax8i8lsA3lHVYyLyG36/fyQDvqp+0u5+\nEdkEYAOA4yICFFMUPxWRm1T1n4Ial43/A+AguhDwG41JRD4L4LcAfEK7WMPbxJ9VkE4BuKri9pUA\nTgc0ltATEQPFYP+Yqj4d9HgqqWpORH6E4tpHkIvdWwDsFJH/AuBSAP9RRB5V1Xv8ePNYpXRU9WVV\n/bCqrlfV9Sj+g/2VbgT7RkTkmoqbOwG8GtRYLCKyHcB/B7BTVZeCHk8I/QTANSKyQURWA7gTwDMB\njymUpDjD+gsAJ1T1fwY9HgAQkbVW5ZmIJAF8EgH/u1PVvap6ZSk+3QngkF/BHohZwA+5CRF5RURe\nQjHlFHjZGoA/A/AfADxfKhdxdtGSAAAAjUlEQVT930EPCABE5NMicgrAxwEcFJGZIMZRWtD+AoAZ\nFBchn1DVhSDGUklEHgfwYwBDInJKRD4X9JhQnLn+HoCtpb9L86VZbJA+AuBw6d/cT1DM4ftaBhk2\n3GlLRBQTnOETEcUEAz4RUUww4BMRxQQDPhFRTDDgExHFBAM+EVFMMOATEcUEAz4RUUz8O8RjlBVo\nzLgUAAAAAElFTkSuQmCC\n",
   "text/plain": "<matplotlib.figure.Figure at 0x7f096aec06a0>"
  },
  "metadata": {},
  "output_type": "display_data"
 }
]
```

## 训练

为了直观的检查训练的过程，可以用图标将训练过程中的数据展示出来

```{.python .input  n=168}
def plot_learning_loss(losses, num):
    x = np.arange(len(losses))
    y = np.array(losses)/num
    plt.plot(x, y, '-*r')
    plt.show()
    
def plot_result_comple(params):
    sample_size = 100
    x, y = data_set_generate(sample_size)
    input_datas = nd.zeros((sample_size, 3))
    input_datas[:,:2] = x
    input_datas[:,2] += 1 
    yhat = linear_module(input_datas, params)
    plt.plot(x[:, 1].asnumpy(), y.asnumpy(), 'or', label='Estimated')
    plt.plot(x[:, 1].asnumpy(), yhat.asnumpy(), '*g', label='Real')
    plt.show()
```

将上面产生的数据集作为训练的输入数据

```{.python .input  n=176}
import time
def learning(datas, labels, params, rate, iter_time):
    loss_list = []
    params.attach_grad()
    for cnt in range(iter_time):
        with ag.record():
            yhat = linear_module(datas, params)
            loss = cost_function(yhat, labels)
        loss.backward()
        grad_descent(params, rate)
        loss_list.append(loss.asscalar())
#         print(yhat, loss, params.grad)
    return loss_list
    
data_number = 1000
learning_rate = 0.0003
iterate_time = 8

params = nd.zeros((3,))
w = params[:2]
b = params[2]
input_datas = nd.zeros((data_number, 3))
input_datas[:,:2] = test_datas[:data_number,:]
input_datas[:,2] += 1 
input_labels = labels[:data_number]
# print(input_datas, input_labels)

start_time = time.clock()
losses = learning(input_datas, input_labels, params, learning_rate, iterate_time)
end_time = time.clock()

print('Learning time: %.6f s'%(end_time-start_time))
print('Last Loss: ', losses[-1], '    Average losss:  %.6f'%(losses[-1]/data_number))
print('After learning: w =', w.asnumpy(), '   b =', b.asnumpy())
plot_learning_loss(losses, data_number)
print('Test:')
plot_result_comple(params)
```

```{.json .output n=176}
[
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "Learning time: 0.004985 s\nLast Loss:  11.3604     Average losss:  0.011360\nAfter learning: w = [ 2.40551901 -4.99803543]    b = [ 9.99399853]\n"
 },
 {
  "data": {
   "image/png": "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\n",
   "text/plain": "<matplotlib.figure.Figure at 0x7f096ad217f0>"
  },
  "metadata": {},
  "output_type": "display_data"
 },
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "Test:\n"
 },
 {
  "data": {
   "image/png": "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\n",
   "text/plain": "<matplotlib.figure.Figure at 0x7f096adfb128>"
  },
  "metadata": {},
  "output_type": "display_data"
 }
]
```

## 使用gluon

### 1. 使用gluon的data模块读取数据

由于一般机器学习/深度学习的数据量都是非常大的，所以不能像上面那样一次全部加载内存，而需要分块加载，使用gluon的data模块来加载数据，可以制定分块的大小，数据源仍然沿用之前生成的。

```{.python .input  n=277}
from mxnet import gluon

batch_size = 100
data_set = gluon.data.ArrayDataset(test_datas,labels)
data_iter = gluon.data.DataLoader(data_set, batch_size, shuffle=True)
```

可以测试一下导入的情况，检查第一组导入的数据：

```{.python .input  n=230}
for data, label in data_iter:
    print(data, label)
    break
```

```{.json .output n=230}
[
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "\n[[-1.16337144  1.61578774]\n [-0.45300296  0.15996423]\n [-0.85275602  0.71872622]\n [-2.21845317 -0.13444795]\n [ 0.40622875  1.6078006 ]\n [-0.09168742 -2.08090711]\n [ 1.82634223 -1.3291446 ]\n [ 0.64555043  1.05994403]\n [-0.87950945  1.22743475]\n [-0.30682316  0.46789315]]\n<NDArray 10x2 @cpu(0)> \n[ -0.767524     8.15800953   4.45539904   5.26917553   3.01678538\n  20.14742661  21.21583557   6.12998009   1.71786261   6.98603868]\n<NDArray 10 @cpu(0)>\n"
 }
]
```

### 2. 使用gluon的nn模块定义模型

在gluon中提供了大量的定制好的层，我们只需要组合这些层来构建我们的模型即可。基本整个过程是：

1. 生成一个Sequential容器对象
1. 使用Sequential容器来装线性模型对应Dense层，并指定多少个个输出节点
3. 初始化Sequential

```{.python .input  n=278}
net = gluon.nn.Sequential()
net.add(gluon.nn.Dense(1))
net.initialize()
print(net)
```

```{.json .output n=278}
[
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "Sequential(\n  (0): Dense(None -> 1, linear)\n)\n"
 }
]
```

### 3. 定义代价函数

直接在gluon的loss模块中选择需要的代价函数，这里是方差loss

```{.python .input  n=279}
square_loss = gluon.loss.L2Loss()
```

### 4. 使用随机梯度下降优化

前面手动写的时候是批梯度下降，这里在gluon.loss模块中可以选择更快的随机梯度下降。

```{.python .input  n=280}
trainer = gluon.Trainer(net.collect_params(), 'sgd', {'learning_rate': 0.1})
```

### 5. 训练

由于使用了分块，所以这里需要用循环导入所有的数据块：

```{.python .input  n=281}
def learning_gluon(data_iter, batch_size, iter_time):
    loss_list = []
    for cnt in range(iter_time):
        loss_sum = 0        
        for data, label in data_iter:  
            with ag.record():
                yhat = net(data)
                loss = square_loss(yhat, label) 
            loss.backward()
            trainer.step(batch_size)
            loss_sum += nd.sum(loss)
        loss_list.append(loss_sum.asscalar())
        print('-->')
    return loss_list

iter_time = 4

start_time = time.clock()
losses = learning_gluon(data_iter, batch_size, iter_time)
end_time = time.clock()
dense = net[0]
w = dense.weight.data()
b = dense.bias.data()

print('Learning time: %.6f s'%(end_time-start_time))
print('Last Loss: ', losses[-1], '    Average losss:  %.6f'%(losses[-1]/data_number))
print('After learning: w =', w.asnumpy(), '   b =', b.asnumpy())
plot_learning_loss(losses, data_number)
print('Test:')
params = nd.arange(3)
params[0] = w[0][0]
params[1] =w[0][1]
params[2] = b
plot_result_comple(params)
```

```{.json .output n=281}
[
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "-->\n-->\n-->\n-->\nLearning time: 0.729790 s\nLast Loss:  49.9733     Average losss:  0.049973\nAfter learning: w = [[ 2.40143061 -5.0005455 ]]    b = [ 10.00155544]\n"
 },
 {
  "data": {
   "image/png": "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\nRU5ErkJggg==\n",
   "text/plain": "<matplotlib.figure.Figure at 0x7f096ac8e550>"
  },
  "metadata": {},
  "output_type": "display_data"
 },
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "Test:\n"
 },
 {
  "data": {
   "image/png": "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\n",
   "text/plain": "<matplotlib.figure.Figure at 0x7f096ae25f98>"
  },
  "metadata": {},
  "output_type": "display_data"
 }
]
```

## 总结

以上使用两种方法实现线性回归这个简单的机器学习算法，很明显gluon提供的很多实现好的模型，只需要我们自己利用这些小模型去搭建，在负责的系统中就很方便了。

运行时，我们发现手动写的代码运行时间反而快很多，这主要是由于gluon的版本使用了随机梯度的下降算法，训练数据集不是一个整体导入的，这就多使用了很多次python的for循环，大大让效率降低了很多；另外在自己写的时候，出了训练的迭代其他的计算基本上全部是ndarry矩阵化的，所以效率高。

但是也可以看到随机梯度收敛快，使用全部数据集的迭代次数少。
